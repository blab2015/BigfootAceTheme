{#<div class="row">#}
    {#<div class="col-sm-12">#}
        {#<div class="widget-box">#}
            {#<div class="widget-header">#}
                {#<h4>{{ list_title | trans }}</h4>#}
                {#<span class="widget-toolbar">#}
                {#{% if theme.page_content.globalActions is defined and theme.page_content.globalActions|length %}#}
                    {#<div class="widget-icons pull-right">#}
                        {#{% for item in theme.page_content.globalActions.items %}#}
                            {#{% include 'BigfootCoreBundle:menu:item.html.twig' %}#}
                        {#{% endfor %}#}
                    {#</div>#}
                {#{% endif %}#}
                {#</span>#}
            {#</div>#}
            {#<div class="widget-body">#}
                {#<div class="widget-main">#}
                    {#<div class="row">#}
                        {#<div class="col-xs-12">#}
                            {#<div class="table-responsive">#}
                                {#<table id="sample-table-1" class="table table-striped table-bordered table-hover">#}
                                    {#<thead>#}
                                    {#<tr>#}
                                        {#{% for attr, field in fieldsList %}#}
                                            {#<th>{{ field | trans }}</th>#}
                                        {#{% endfor %}#}
                                        {#<th>{{ 'Actions' | trans }}</th>#}
                                    {#</tr>#}
                                    {#</thead>#}
                                    {#<tbody>#}
                                    {#{% for entity in entities %}#}
                                        {#<tr>#}
                                            {#{% for attr, field in fieldsList %}#}
                                                {#<td>{{ attribute(entity, attr) }}</td>#}
                                            {#{% endfor %}#}
                                            {#<td>#}
                                                {#<div class="btn-group">#}
                                                    {#<a class="btn btn-link" href="{{ path(action_edit, { 'id': entity.id }) }}"><i class="icon-pencil"></i></a>#}
                                                {#</div>#}
                                            {#</td>#}
                                        {#</tr>#}
                                    {#{% endfor %}#}
                                    {#</tbody>#}
                                {#</table>#}
                            {#</div>#}
                        {#</div>#}
                    {#</div>#}
                {#</div>#}
            {#</div>#}
        {#</div>#}
    {#</div>#}
{#</div>#}

{% if theme.page_content.globalActions is defined and theme.page_content.globalActions|length %}
    <div class="widget-icons">
        {% for item in theme.page_content.globalActions.items %}
            {% include 'BigfootCoreBundle:menu:item.html.twig' %}
        {% endfor %}
    </div>
{% endif %}
<table id="grid-table"></table>
<div id="grid-pager"></div>

<script type="text/javascript">

var $path_base = "/";//this will be used in gritter alerts containing images

var grid_data =
        [
            {% for entity in entities %}
                {
                {% for attr, field in fieldsList %}
                    {{ field | replace({' ': '_'}) }}:"{{ attribute(entity, attr) }}"{% if loop.last == false %},{% endif %}
                {% endfor %}
                }{% if loop.last == false %},{% endif %}
            {% endfor %}
        ];

jQuery(function($) {
    var grid_selector = "#grid-table";
    var pager_selector = "#grid-pager";

    jQuery(grid_selector).jqGrid({

        data: grid_data,
        datatype: "local",
        height: 400,
        colNames:[{% for attr, field in fieldsList %}'{{ field | trans }}'{% if loop.last == false %},{% endif %} {% endfor %}, '{{ 'Actions' | trans }}'],
        colModel:[
            {% for attr, field in fieldsList %}
            { name:'{{ field | trans | replace({' ': '_'}) }}', index:'{{ field | trans | replace({' ': '_'}) }}' },
            {% endfor %}
            {name:'test', width:80, fixed:true, sortable:false, resize:false, formatter:linkformatter}
        ],

        viewrecords : true,
        rowNum:10,
        rowList:[10,20,30],
        pager : pager_selector,
        altRows: true,

        multiboxonly: true,

        loadComplete : function() {
            var table = this;
            setTimeout(function(){
                styleCheckbox(table);

                updateActionIcons(table);
                updatePagerIcons(table);
                enableTooltips(table);
            }, 0);
        },

        autowidth: true,
        caption: "{{ list_title | trans }}"

    });

    function linkformatter(cellValue, options, rowdata){
        var route = "{{ path(action_edit, { "id": "PLACEHOLDER" }) }}";
        route = route.replace("PLACEHOLDER", rowdata.ID);
        return '<a class="btn btn-link" href="'+route+'"><i class="icon-pencil"></i></a>';
    }

    //navButtons
    jQuery(grid_selector).jqGrid('navGrid',pager_selector,
            { 	//navbar options
                edit: false,
                add: false,
                del: false,
                search: true,
                searchicon : 'icon-search orange',
                refresh: true,
                refreshicon : 'icon-refresh green',
                view: false
            },
            {
                recreateForm: true,
                beforeShowForm : function(e) {
                    var form = $(e[0]);
                    form.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class="widget-header" />')
                    style_edit_form(form);
                }
            },
            {
                //new record form
                closeAfterAdd: true,
                recreateForm: true,
                viewPagerButtons: false,
                beforeShowForm : function(e) {
                    var form = $(e[0]);
                    form.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class="widget-header" />')
                    style_edit_form(form);
                }
            },
            {
                //delete record form
                recreateForm: true,
                beforeShowForm : function(e) {
                    var form = $(e[0]);
                    if(form.data('styled')) return false;

                    form.closest('.ui-jqdialog').find('.ui-jqdialog-titlebar').wrapInner('<div class="widget-header" />')
                    style_delete_form(form);

                    form.data('styled', true);
                },
                onClick : function(e) {
                    alert(1);
                }
            },
            {
                //search form
                recreateForm: true,
                afterShowSearch: function(e){
                    var form = $(e[0]);
                    form.closest('.ui-jqdialog').find('.ui-jqdialog-title').wrap('<div class="widget-header" />')
                    style_search_form(form);
                },
                afterRedraw: function(){
                    style_search_filters($(this));
                }
                ,
                multipleSearch: true,
                /**
                 multipleGroup:true,
                 showQuery: true
                 */
            },
            {
                //view record form
                recreateForm: true,
                beforeShowForm: function(e){
                    var form = $(e[0]);
                    form.closest('.ui-jqdialog').find('.ui-jqdialog-title').wrap('<div class="widget-header" />')
                }
            }
    )
});
</script>
